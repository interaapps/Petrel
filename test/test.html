<!DOCTYPE html>
<html lang="en" style="height: 100%">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/highlight/pastefy.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>

    <link rel="stylesheet" href="../css/dark.css">
</head>
<body style="height: 100%; box-sizing: border-box;">
    <div style="max-width: 900px; margin: auto; padding-top: 20px;">
        <h1>Petrel Code Editor</h1>
        <div id="code-editor" style="min-height: 400px; width: 100%"></div>
    </div>
    <script type="module">
        import CodeEditor from '../src/CodeEditor.js'
        import JavaScriptAutoComplete from '../src/languages/JavaScriptAutoComplete.js'
        import JavaAutoComplete from '../src/languages/JavaAutoComplete.js'
        import PHPAutoComplete from '../src/languages/PHPAutoComplete.js'

        const codeEditor = new CodeEditor(document.getElementById("code-editor"))
            .setHighlighter(code => hljs.highlight("java", code).value)
            .setValue(
                `package de.interaapps.quotysco.backend.model;

import org.javawebstack.orm.Model;
import org.javawebstack.orm.Repo;
import org.javawebstack.orm.annotation.Column;
import org.javawebstack.orm.annotation.Dates;

import java.sql.Timestamp;
import java.util.List;
import java.util.Map;

@Dates
public class Post extends Model {
    @Column
    public int id;

    @Column(size = 150)
    public String url;

    @Column
    public String title;

    @Column
    public String image;

    @Column
    public String contents;

    @Column(size = 25)
    public String userId;

    @Column
    public int blogId;

    @Column
    public State state;

    @Column
    public Timestamp createdAt;

    @Column
    public Timestamp updatedAt;


    public static Post getByBlogAndUrl(Blog blog, String url){
        return Repo.get(Post.class).where("blogId", blog.id).where("url", url).and(q->q.where("state", State.PUBLISHED).orWhere("state", State.UNLISTED)).first();
    }

    public static Post getByBlogAndUrl(String blogName, String url){
        Blog blog = Blog.getByName(blogName);
        return blog != null ? getByBlogAndUrl(blog, url) : null;
    }

    public enum State {
        DRAFT,
        UNLISTED,
        PUBLISHED
    }

    public void delete(){
        Repo.get(PostCategory.class).where("postId", id).delete();
        Repo.get(UserPostLike.class).where("postId", id).delete();
        Repo.get(GlobalPostInterestInteraction.class).where("postId", id).delete();
        super.delete();
    }
}
`    )
            .setAutoCompleteHandler(new JavaAutoComplete())
            .create()
    </script>
</body>
</html>